---
title: "Global Temperature Trends in a Warming World"
author: "Samuel Meads"
date: "(`r format(Sys.time(), '%d %B, %Y')`)"
output: 
  github_document: 
      toc: true
---

![](/Users/sm/Desktop/DataScience/APY313_S24/APY313_DataPractical_Final/Pictures/ClimateChange.jpg)
```{r, message=FALSE}
# Import Libraries
library(tidyverse)
library(dplyr)
library(knitr)
library(ggplot2)
library(tidyr)
library(reticulate)
```

# Introduction

The relationship between the escalating concentrations of greenhouse gases, specifically carbon dioxide (CO₂) and methane (CH₄), and the increases in global average temperatures support contemporary understanding of climate dynamics. This connection not only highlights the anthropogenic impacts on climate change but also serves as a critical point for scientific questions aimed at explaining the effects and potential mitigation strategies for global warming.

Historical and modern scientific efforts have greatly contributed to the understanding of this relationship. Eunice Foote and, later in the 19th century, John Tyndall, with their pioneering experiments, both proved the heat-trapping characteristics of CO₂, as part of the basic knowledge toward the greenhouse effect, which is necessary for modern-day climatic science (Armstrong et al., 2018). In the 20th century, scientists, including Mann et al. (1998), further attempted to provide an explanation for the dominant role of the gases in recent climate variability and to confirm the continual impact that had already been observed in earlier research by using paleoclimatic information to link changes in greenhouse gas concentrations with large-scale temperature patterns.
The most recent studies, for instance, Hansen et al. (2006) and Mann et al. (1998), have not only upheld the early findings with great analysis but have continued to argue out how these gases influence modern climatic patterns. Some of these include changes in sea surface temperatures (SSTs) and their link to key climate events such as the El Niño. His work, through the documentary, indeed underscores near effects of these gases and points out to the constant increase in the temperatures around the world, which is in line with past predictions and models that sought to establish the trajectory of climate change.

They increasingly report that the increase of world temperatures is very much related to rising sea levels—one of those things they are seeing more often in climate studies of recent years. Mitchell (1989) pointed out that the enhanced greenhouse gas concentrations have warmed not only the atmosphere but have also contributed to its thermal expansion, melting ice caps, which have emerged as major factors for the increased observed rise in sea levels over the past century.

Building on these foundational experiments and studies, the present research aims to delve deeper into the correlations and causal relationships between the increases in specific greenhouse gases with global temperature trends. Using context from these studies and modern technological and methodological advances, this piece of work contributes to having a more cohesive understanding of the mechanisms involved in climate change by potentially confirming or challenging past findings.


# Methods

## Research Objective
The following research aim's to identify the relationship between particular greenhouse gases (CO₂ and CH₄) and global average temperature. Additionally, I want to investigate the effects that global average temperature has on sea level. The discoveries made will be pivotal for enhancing the accuracy of climate models, which are crucial for predicting and mitigating future climate impacts. Hopefully the results can better inform policy decisions and develop effective strategies for protecting coastal communities and ecosystems against the impending rise of global temperatures and sea levels.

### Null Hypotheses (H<sub>0</sub>):
There is no significant linear relationship between the levels of CO₂, CH₄, and changes in global average temperature.

There is no significant linear relationship between

### Alternative Hypothesis (H<sub>1</sub>):
There is a significant linear relationship between CO₂, CH₄, and changes in global average temperature.

## Data Analyses

### Data

The Data comes from [NASA](https://climate.nasa.gov/vital-signs/carbon-dioxide/?intent=111). The files themselves are only downloadable in .txt format, so I used used Python to convert these files into .csv format for easier data observation and manipulation:

```{python, message=FALSE, results='hide'}
import csv
import os

input_file_path = '/Users/sm/Desktop/DataPractical/CarbonDioxide.txt'
output_file_path = '/Users/sm/Desktop/DataPractical/CarbonDioxide.csv'

# Check if the file already exists to avoid rewriting it
if not os.path.exists(output_file_path):
  # Open the input text file and the output CSV file
  with open(input_file_path, 'r') as txt_file, open(output_file_path, 'w', newline='') as csv_file:
    csv_writer = csv.writer(csv_file)
    # Write the CSV header
    csv_writer.writerow(
      ["Year", "Month", "Decimal Date", "Monthly Average", "De-seasonalized", "#Days", "St.Dev", "Unc. of Mon Mean"])
      
    for line in txt_file:
      # Skip lines that do not start with a number (to avoid headers and comments)
      if not line.strip().split()[0].isdigit():
        continue
      
      # Split the line into components based on whitespace
      parts = line.split()
      # Reconstruct the data row according to the CSV format we want
      data_row = parts[:8]
      csv_writer.writerow(data_row)
else:
    print(f'File already exists: {output_file_path}')
```

```{r, echo=FALSE, results='asis'}
output_file_path <- "/Users/sm/Desktop/DataPractical/CarbonDioxide.csv"
cat(sprintf('<a href="%s" download>Click to download Carbon Dioxide CSV file</a>', output_file_path))
```

```{python, message=FALSE, results='hide'}
import csv
import os

# Define the path to the input text file and the output CSV file
input_file_path = '/Users/sm/Desktop/DataPractical/GlobalTemp.txt'
output_file_path = '/Users/sm/Desktop/DataPractical/GlobalTemp.csv'

# Check if the file already exists to avoid rewriting it
if not os.path.exists(output_file_path):
  # Open the input text file and the output CSV file
  with open(input_file_path, 'r') as txt_file, open(output_file_path, 'w', newline='') as csv_file:
    csv_writer = csv.writer(csv_file)
    # Write the header row to the CSV file
    csv_writer.writerow(["Year", "No_Smoothing", "Lowess(5)"])
    
    # Skip the initial header lines
    for _ in range(5):
        next(txt_file)

    for line in txt_file:
        # Split the line into components based on whitespace
        parts = line.split()
        # Check if the line is not empty and then write the data to the CSV file
        if parts:
            csv_writer.writerow(parts)
else:
  print(f'File already exists: {output_file_path}')
```

```{r, echo=FALSE, results='asis'}
output_file_path <- "/Users/sm/Desktop/DataPractical/GlobalTemp.csv"
cat(sprintf('<a href="%s" download="GlobalTemp.csv">Click to download Global Temperature CSV file</a>', output_file_path))
```

```{python, message=FALSE, results='hide'}
import csv
import os

input_file_path = '/Users/sm/Desktop/DataPractical/Methane.txt'
output_file_path = '/Users/sm/Desktop/DataPractical/Methane.csv'

# Check if the file already exists to avoid rewriting it
if not os.path.exists(output_file_path):
  # Open the input text file and the output CSV file
  with open(input_file_path, 'r') as txt_file, open(output_file_path, 'w', newline='') as csv_file:
    csv_writer = csv.writer(csv_file)
    csv_writer.writerow(["Year", "Mean", "Uncertainty"])
    
    # Skip the initial lines that don't contain data
    for line in txt_file:
        if line.startswith("#") or not line.strip():
            continue  # Skip comments and empty lines
        # Split the line and write the relevant parts to the CSV
        parts = line.split()
        if parts:
            csv_writer.writerow(parts)
else:
  print(f'File already exists: {output_file_path}')
```

```{r, echo=FALSE, results='asis'}
output_file_path <- "/Users/sm/Desktop/DataPractical/Methane.csv"
cat(sprintf('<a href="%s" download="Methane.csv">Click to download Methane CSV file</a>', output_file_path))
```

```{python, message=FALSE, results='hide'}
import csv
import os

input_file_path = '/Users/sm/Desktop/DataPractical/SeaLevel.txt'
output_file_path = '/Users/sm/Desktop/DataPractical/SeaLevel.csv'

# Define the columns as per the file's documentation
columns = [
    "Altimeter Type", "Merged File Cycle #", "Year + Fraction of Year",
    "Number of Observations", "Number of Weighted Observations",
    "GMSL Variation (No GIA) (mm)", "Std Dev GMSL (No GIA) (mm)",
    "Smoothed GMSL (No GIA) (mm)", "GMSL Variation (GIA) (mm)",
    "Std Dev GMSL (GIA) (mm)", "Smoothed GMSL (GIA) (mm)",
    "Smoothed GMSL (GIA, No Seasonal) (mm)", "Smoothed GMSL (No GIA, No Seasonal) (mm)"
]

# Check if the file already exists to avoid rewriting it
if not os.path.exists(output_file_path):
  # Open the input text file and the output CSV file
  with open(input_file_path, 'r') as txt_file, open(output_file_path, 'w', newline='') as csv_file:
    csv_writer = csv.writer(csv_file)
    csv_writer.writerow(columns)

    # Skip header lines
    for line in txt_file:
        if line.strip() == "HDR Header_End---------------------------------------":
            break  # End of header, start of data

    for line in txt_file:
        # Skip empty lines or lines that do not start with numeric data
        if not line.strip() or not line[0].isdigit():
            continue

        # Split the line and write the relevant parts to the CSV
        parts = line.split()
        if parts:
            csv_writer.writerow(parts)
else:
  print(f'File already exists: {output_file_path}')
```

```{r, echo=FALSE, results='asis'}
output_file_path <- "/Users/sm/Desktop/DataPractical/SeaLevel.csv"
cat(sprintf('<a href="%s" download="SeaLevel.csv">Click to download Sea Level CSV file</a>', output_file_path))
```

```{r, message=FALSE}
# Import data
co2_data <- read_csv('https://raw.githubusercontent.com/sammeadss/climate/main/Data/CarbonDioxide.csv')
methane_data <- read_csv('https://raw.githubusercontent.com/sammeadss/climate/main/Data/GlobalTemp.csv')
globtemp_data <- read_csv('https://raw.githubusercontent.com/sammeadss/climate/main/Data/Methane.csv')
sealevel_data <- read_csv('https://raw.githubusercontent.com/sammeadss/climate/main/Data/SeaLevel.csv')
```

```{r}
head(co2_data)
head(methane_data)
head(globtemp_data)
head(sealevel_data)
```

### Descriptive Statistics

### Exploratory Data Analysis

### Time Series Analysis 

### Correlation and Causation Analysis

### Regression Analysis

### Casual Inference

### Model Evaluation

### Statistical Testing

### Sensitivity and Scenario Analysis


```{r}
co2_annual <- co2_data %>%
  filter(Year >= 1984) %>%
  group_by(Year) %>%
  summarize(AnnualAverageCO2 = mean(`Monthly Average`, na.rm = TRUE))

methane_annual <- methane_data %>%
  group_by(Year) %>%
  summarize(AnnualAverageMethane = mean(No_Smoothing, na.rm = TRUE))

temp_annual <- globtemp_data %>%
  filter(Year >= 1984) %>%
  select(Year, Mean) %>%
  rename(AnnualAverageTemp = Mean)
```

```{r}
combined_data <- merge(co2_annual, methane_annual, by = "Year")
combined_data <- merge(combined_data, temp_annual, by = "Year")
colnames(combined_data)
```

```{r}
# Time series plot for CO2 Levels
ggplot(data = combined_data, aes(x = Year, y = AnnualAverageCO2)) +
  geom_line(color = "blue") +
  ggtitle("CO2 Levels Over Time") +
  xlab("Year") +
  ylab("CO2 Levels (ppm)") +
  theme_minimal()
```

```{r}
# Time series plot for Global Temperature Anomalies
ggplot(data = combined_data, aes(x = Year, y = AnnualAverageTemp)) +
  geom_line(color = "red") +
  ggtitle("Global Temperature Anomalies Over Time") +
  xlab("Year") +
  ylab("Temperature Anomaly (C°)") +
  theme_minimal()
```

```{r}
# Time series plot for Methane Concentrations
ggplot(data = combined_data, aes(x = Year, y = AnnualAverageMethane)) +
  geom_line(color = "green") +
  ggtitle("Methane Concentrations Over Time") +
  xlab("Year") +
  ylab("Methane (ppb)") +
  theme_minimal()
```

```{r}
# Scatter plot for CO2 Levels vs. Global Temperature Anomalies
ggplot(data = combined_data, aes(x = AnnualAverageCO2, y = AnnualAverageTemp)) +
  geom_point(color = "blue") +
  ggtitle("CO2 Levels vs. Global Temp Anomalies") +
  xlab("CO2 Levels (ppm)") +
  ylab("Global Temp Anomaly (C°)") +
  theme_minimal()
```

```{r}
# Scatter plot for Methane Concentrations vs. Global Temperature Anomalies
ggplot(data = combined_data, aes(x = AnnualAverageMethane, y = AnnualAverageTemp)) +
  geom_point(color = "green") +
  ggtitle("Methane Concentrations vs. Global Temp Anomalies") +
  xlab("Methane (ppb)") +
  ylab("Global Temp Anomaly (C°)") +
  theme_minimal()
```

```{r}
# Linear regression of Global Temp Anomaly on CO2 Levels
lm_CO2 = lm(AnnualAverageTemp ~ AnnualAverageCO2, data = combined_data)
summary(lm_CO2)
```

```{r}
# Linear regression of Global Temp Anomaly on Methane levels
lm_Methane = lm(AnnualAverageTemp ~ AnnualAverageMethane, data = combined_data)
summary(lm_Methane)
```

# Results

# Conclusion

# References 

## Articles

Armstrong, Anne K., et al. CLIMATE CHANGE SCIENCE: The Facts. Communicating Climate Change: A Guide for Educators, Cornell University Press, 2018, pp. 7-20. JSTOR, http://www.jstor.org/stable/10.7591/j.ctv941wjn.5.

Hansen, James, et al. "Global Temperature Change." Proceedings of the National Academy of Sciences, vol. 103, no. 39, 26 Sept. 2006, pp. 14288–14293. PNAS, www.pnas.org/cgi/doi/10.1073/pnas.0606291103. 

Mann, Michael E., Raymond S. Bradley, and Malcolm K. Hughes. "Global-Scale Temperature Patterns and Climate Forcing Over the Past Six Centuries." Nature, vol. 392, 23 Apr. 1998, pp. 779-787, https://www.nature.com/articles/33859

Mitchell, J. F. B. "The 'Greenhouse' Effect and Climate Change." Rev. Geophys., vol. 27, no. 1, 1989, pp. 115-139, doi:10.1029/RG027i001p00115.

## Data

National Aeronautics and Space Administration. "Climate Change: Vital Signs of the Planet." NASA, n.d., https://science.nasa.gov/climate-change/.

## Pictures

"Electric Towers During Golden Hour." Pexels, uploaded by Pixabay, https://www.pexels.com/photo/electric-towers-during-golden-hour-221012/.



